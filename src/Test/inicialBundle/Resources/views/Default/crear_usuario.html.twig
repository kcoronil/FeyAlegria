{% extends '::plantilla.html.twig' %}
{# bootstrap_3_layout.html.twig #}
{% if form is defined %}
    {% form_theme form "::bootstrap_3_layout.html.twig" %}
{% endif %}
{% macro widget_prototype(widget, remove_text) %}
    {% if widget.vars.prototype is defined %}
        {% set form = widget.vars.prototype %}
        {% set name = widget.vars.prototype.vars.name %}
    {% else %}
        {% set form = widget %}
        {% set name = widget.vars.full_name %}
    {% endif %}

    <div data-content="{{ name }}">
        <a class="btn-remove" data-related="_self.widget_prototype(form.alumno, 'Remove alumno')|escape ">{{ remove_text }}</a>
        <div class="col-sm-12 ">
            <h4 class="text-center">Nuevo Alumno</h4>
            <div class="col-sm-3 ">
                {{ form_row(form.cedula) }}
                {{ form_row(form.cedulaEstudiantil) }}
            </div>
            <div class="col-sm-4 ">
                {{ form_row(form.apellidos) }}
                {{ form_row(form.nombres) }}
            </div>
            <div class="col-sm-4 ">
                {{ form_row(form.fechaNacimiento) }}
                {{ form_row(form.lugarNacimiento) }}
            </div>
            <div class="col-sm-1 ">
                {{ form_row(form.sexo) }}
            </div>
        </div>
    </div>
{% endmacro %}
{% block extra_head %}
    <script type="text/javascript">
            $(document).ready(function() {
                $('.btn-add').click(function(event) {
                    var collectionHolder = $('#' + $(this).attr('data-target'));
                    var prototype = collectionHolder.attr('data-prototype');
                    var form = prototype.replace(/__name__/g, collectionHolder.children().length);

                    collectionHolder.append(form);
                    $('.datepick').not('.hasDatePicker').datepicker({
                        format: "yyyy/mm/dd",
                        language:"es"
                    });
                    $('.datepick').on('change', function(){
                        $('.datepicker').hide();
                    });
                    return false;
                });
                $('.btn-remove').on('click', function(event) {
                    var name = $(this).attr('data-related');
                    $('*[data-content="'+name+'"]').remove();

                    return false;
                });
            });


    </script>
{% endblock %}
{% block enlace_atajo %}
    <li><a href="{{ path('inicial_lista_usuario') }}">Consultar Usuarios</a></li>
{% endblock %}
{% block content %}
    <div class="row text-center">
        <h2 class="clase">{{ accion }}</h2>
        {% if form is defined %}
            <div class="col-sm-12 text-left">
                <div class="col-sm-12">
                    {{ form_start(form) }}
                    <div class="col-sm-4 ">
                        {% if form.tipoUsuario is defined %}
                            {{ form_row(form.tipoUsuario) }}
                        {% else %}
                            <label class="control-label required">Representante Principal</label>
                        {% endif %}
                        {% if form.principal is defined %}
                            {{ form_row(form.principal) }}
                        {% endif %}
                        {{ form_row(form.cedula) }}
                    </div>
                    <div class="col-sm-4 ">
                        {{ form_row(form.apellidos) }}
                        {{ form_row(form.nombres) }}
                        {{ form_row(form.fechaNacimiento) }}
                    </div>
                    <div class="col-sm-4 ">
                        {{ form_row(form.direccion) }}
                    </div>
                    <div class="col-sm-4 ">
                    {{ form_row(form.sexo) }}
                    </div>
                    <div id="post_alumno" data-prototype="{{ _self.widget_prototype(form.alumno, 'eliminar alumno')|escape }}">
                        {% for widget in form.alumno.children %}
                            {{ _self.widget_prototype(widget, 'remover alumno') }}
                        {% endfor %}
                    </div>
                    <div class="col-sm-12 text-center ">
                        <a class="btn-add btn btn-default" data-target="post_alumno">Agregar Alumno</a>

                    </div>
                    <div class="col-sm-12 text-center ">
                        {{ form_row(form.guardar) }}
                        {{ form_row(form.guardar_crear) }}
                        {{ form_end(form) }}
                    </div>

                </div>
            </div>
        {% endif %}
     </div>
{% endblock %}